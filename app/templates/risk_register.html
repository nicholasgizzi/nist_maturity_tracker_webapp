{% extends 'layout.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Risk Register</h2>
  <a href="{{ url_for('risks.add_risk') }}" class="btn btn-primary">New Risk</a>
</div>

<table id="risks-table" class="table table-striped">
  <thead>
    <tr>
      <th>Risk ID</th>
      <th>Description</th>
      <th>Risk Score</th>
      <th>Priority</th>
      <th>Owner</th>
      <th>Created</th>
    </tr>
  </thead>
  <tbody>
  {% for r in risks %}
    <tr>
      <td>
        <a href="{{ url_for('risks.view_risk', risk_id=r.id) }}">
          {{ r.code }}
        </a>
      </td>
      <td>{{ r.description }}</td>
      <td>{{ r.risk_score }}</td>
      <td>
        <span class="badge" style="background-color: {{ r.risk_color }};">
          {{ r.risk_level }}
        </span>
      </td>
      <td>{{ r.owner }}</td>
      <td>{{ r.created_at.strftime('%Y-%m-%d') }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<script>
  // initialize DataTables (make sure you include its JS/CSS)
  document.addEventListener('DOMContentLoaded', () => {
    $('#risks-table').DataTable();
  });
</script>
{% endblock %}